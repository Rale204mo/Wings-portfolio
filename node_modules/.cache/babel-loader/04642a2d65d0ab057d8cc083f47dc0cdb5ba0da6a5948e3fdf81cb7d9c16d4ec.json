{"ast":null,"code":"import _objectSpread from\"C:/Users/DEll/Videos/wings/node_modules/@babel/runtime/helpers/esm/objectSpread2.js\";import React,{useEffect,useState}from'react';import{getSales,addSale,getProducts,getCustomers,getStock,updateStock}from'../../Db';import'./Sales.css';import{jsx as _jsx,jsxs as _jsxs}from\"react/jsx-runtime\";export default function Sales(){const[sales,setSales]=useState([]);const[products,setProducts]=useState([]);const[customers,setCustomers]=useState([]);const[stock,setStock]=useState([]);const[form,setForm]=useState({productId:'',customerId:'',amount:0,date:''});const fetchAll=async()=>{setSales((await getSales()).data);setProducts((await getProducts()).data);setCustomers((await getCustomers()).data);setStock((await getStock()).data);};useEffect(()=>{fetchAll();},[]);const handleSale=async e=>{e.preventDefault();const prodId=Number(form.productId);const qtyToReduce=1;// one unit per sale in this simple example\n// find stock item\nconst stockItem=stock.find(s=>s.productId===prodId);if(!stockItem||stockItem.quantity<=0){alert('Insufficient stock for this product');return;}// create sale\nawait addSale({productId:prodId,customerId:Number(form.customerId),amount:Number(form.amount),date:form.date||new Date().toISOString().slice(0,10)});// update stock quantity\nawait updateStock(stockItem.id,_objectSpread(_objectSpread({},stockItem),{},{quantity:stockItem.quantity-qtyToReduce}));// fetch again and alert if low\nawait fetchAll();const updated=(await getStock()).data.find(s=>s.productId===prodId);if(updated.quantity<=5){alert('Warning: stock level is low for this product (<=5)');}};return/*#__PURE__*/_jsxs(\"div\",{className:\"sales-container\",children:[/*#__PURE__*/_jsx(\"h2\",{children:\"Sales\"}),/*#__PURE__*/_jsxs(\"form\",{className:\"sales-form\",onSubmit:handleSale,children:[/*#__PURE__*/_jsxs(\"select\",{value:form.productId,onChange:e=>setForm(_objectSpread(_objectSpread({},form),{},{productId:e.target.value})),required:true,children:[/*#__PURE__*/_jsx(\"option\",{value:\"\",children:\"Select product\"}),products.map(p=>/*#__PURE__*/_jsx(\"option\",{value:p.id,children:p.name},p.id))]}),/*#__PURE__*/_jsxs(\"select\",{value:form.customerId,onChange:e=>setForm(_objectSpread(_objectSpread({},form),{},{customerId:e.target.value})),required:true,children:[/*#__PURE__*/_jsx(\"option\",{value:\"\",children:\"Select customer\"}),customers.map(c=>/*#__PURE__*/_jsx(\"option\",{value:c.id,children:c.name},c.id))]}),/*#__PURE__*/_jsx(\"input\",{type:\"number\",value:form.amount,onChange:e=>setForm(_objectSpread(_objectSpread({},form),{},{amount:e.target.value})),placeholder:\"Amount\",required:true}),/*#__PURE__*/_jsx(\"input\",{type:\"date\",value:form.date,onChange:e=>setForm(_objectSpread(_objectSpread({},form),{},{date:e.target.value}))}),/*#__PURE__*/_jsx(\"button\",{type:\"submit\",children:\"Make Sale\"})]}),/*#__PURE__*/_jsx(\"div\",{className:\"sales-list\",children:sales.map(s=>/*#__PURE__*/_jsx(\"div\",{className:\"sale-card\",children:/*#__PURE__*/_jsxs(\"p\",{children:[\"Sale #\",s.id,\" - Product:\",s.productId,\" Customer:\",s.customerId,\" Amount:\",s.amount,\" Date:\",s.date]})},s.id))})]});}","map":{"version":3,"names":["React","useEffect","useState","getSales","addSale","getProducts","getCustomers","getStock","updateStock","jsx","_jsx","jsxs","_jsxs","Sales","sales","setSales","products","setProducts","customers","setCustomers","stock","setStock","form","setForm","productId","customerId","amount","date","fetchAll","data","handleSale","e","preventDefault","prodId","Number","qtyToReduce","stockItem","find","s","quantity","alert","Date","toISOString","slice","id","_objectSpread","updated","className","children","onSubmit","value","onChange","target","required","map","p","name","c","type","placeholder"],"sources":["C:/Users/DEll/Videos/wings/src/components/Sales/Sales.js"],"sourcesContent":["import React, { useEffect, useState } from 'react';\nimport { getSales, addSale, getProducts, getCustomers, getStock, updateStock } from '../../Db';\nimport './Sales.css';\n\nexport default function Sales(){\n  const [sales, setSales] = useState([]);\n  const [products, setProducts] = useState([]);\n  const [customers, setCustomers] = useState([]);\n  const [stock, setStock] = useState([]);\n  const [form, setForm] = useState({productId:'', customerId:'', amount:0, date:''});\n\n  const fetchAll = async ()=>{\n    setSales((await getSales()).data);\n    setProducts((await getProducts()).data);\n    setCustomers((await getCustomers()).data);\n    setStock((await getStock()).data);\n  };\n\n  useEffect(()=>{ fetchAll(); }, []);\n\n  const handleSale = async (e)=>{\n    e.preventDefault();\n    const prodId = Number(form.productId);\n    const qtyToReduce = 1; // one unit per sale in this simple example\n\n    // find stock item\n    const stockItem = stock.find(s => s.productId === prodId);\n    if(!stockItem || stockItem.quantity <= 0){\n      alert('Insufficient stock for this product');\n      return;\n    }\n\n    // create sale\n    await addSale({ productId: prodId, customerId: Number(form.customerId), amount: Number(form.amount), date: form.date || new Date().toISOString().slice(0,10) });\n\n    // update stock quantity\n    await updateStock(stockItem.id, { ...stockItem, quantity: stockItem.quantity - qtyToReduce });\n\n    // fetch again and alert if low\n    await fetchAll();\n    const updated = (await getStock()).data.find(s=>s.productId===prodId);\n    if(updated.quantity <= 5){\n      alert('Warning: stock level is low for this product (<=5)');\n    }\n  };\n\n  return (\n    <div className=\"sales-container\">\n      <h2>Sales</h2>\n      <form className=\"sales-form\" onSubmit={handleSale}>\n        <select value={form.productId} onChange={e=>setForm({...form, productId:e.target.value})} required>\n          <option value=\"\">Select product</option>\n          {products.map(p=> <option key={p.id} value={p.id}>{p.name}</option> )}\n        </select>\n        <select value={form.customerId} onChange={e=>setForm({...form, customerId:e.target.value})} required>\n          <option value=\"\">Select customer</option>\n          {customers.map(c=> <option key={c.id} value={c.id}>{c.name}</option> )}\n        </select>\n        <input type=\"number\" value={form.amount} onChange={e=>setForm({...form, amount:e.target.value})} placeholder=\"Amount\" required />\n        <input type=\"date\" value={form.date} onChange={e=>setForm({...form, date:e.target.value})} />\n        <button type=\"submit\">Make Sale</button>\n      </form>\n\n      <div className=\"sales-list\">\n        {sales.map(s=>(\n          <div key={s.id} className=\"sale-card\">\n            <p>Sale #{s.id} - Product:{s.productId} Customer:{s.customerId} Amount:{s.amount} Date:{s.date}</p>\n          </div>\n        ))}\n      </div>\n    </div>\n  );\n}\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}